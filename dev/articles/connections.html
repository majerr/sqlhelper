<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sqlhelper">
<title>Managing Connections • sqlhelper</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Managing Connections">
<meta property="og:description" content="sqlhelper">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sqlhelper</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sqlhelper.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/connections.html">Managing Connections</a>
    <a class="dropdown-item" href="../articles/execution.html">Executing SQL</a>
    <a class="dropdown-item" href="../articles/use_case.html">Using sqlhelper in packages</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/majerr/sqlhelper/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Managing Connections</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/majerr/sqlhelper/blob/HEAD/vignettes/connections.Rmd" class="external-link"><code>vignettes/connections.Rmd</code></a></small>
      <div class="d-none name"><code>connections.Rmd</code></div>
    </div>

    
    
<p><code>sqlhelper</code> can maintain one or many database connections
internally. This article describes how to configure and create
connections, and the functions for inspecting and accessing them.</p>
<div class="section level2">
<h2 id="creating-connections">Creating connections<a class="anchor" aria-label="anchor" href="#creating-connections"></a>
</h2>
<p>You can define database connections in config files which are read
and processed by the <code><a href="../reference/connect.html">connect()</a></code> function. For example, if
your config file is called <code>my_db_config.yml</code>, you might
run:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://majerr.github.io/sqlhelper/dev/">sqlhelper</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="st">"examples/sqlhelper_db_conf.yml"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="config-files">Config files<a class="anchor" aria-label="anchor" href="#config-files"></a>
</h3>
<p>A config file can contain one or more connection definitions. The
above example defines two simple connections:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"examples/sqlhelper_db_conf.yml"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; #### sqlhelper_db_conf.yml ####</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; simple_sqlite:</span></span>
<span><span class="co">#&gt;   driver_type: sqlite</span></span>
<span><span class="co">#&gt;   description: "A simple connection to an in-memory database"</span></span>
<span><span class="co">#&gt;   connection:</span></span>
<span><span class="co">#&gt;     Server: ":memory:"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; pool_sqlite:</span></span>
<span><span class="co">#&gt;   driver_type: sqlite</span></span>
<span><span class="co">#&gt;   pool: yes</span></span>
<span><span class="co">#&gt;   description: "A pooled connection to an in-memory database"</span></span>
<span><span class="co">#&gt;   connection:</span></span>
<span><span class="co">#&gt;     Server: ":memory:"</span></span></code></pre></div>
<p>Connection definitions are <a href="https://yaml.org/" class="external-link">YAML</a>. The
following YAML chunk defines a connection called ‘dap’.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dap</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">driver_type</span><span class="kw">:</span><span class="at"> sqlserver</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pool</span><span class="kw">:</span><span class="at"> </span><span class="ch">yes</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">  description</span><span class="kw">: </span><span class="ch">&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    Databases managed by ADD teams on the Data and Analytics Platform</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">connection</span><span class="kw">:</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Driver</span><span class="kw">:</span><span class="at"> </span><span class="st">"{ODBC Driver 17 for SQL Server}"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Server</span><span class="kw">:</span><span class="at"> </span><span class="st">"Dap-sql01"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Trusted_Connection</span><span class="kw">:</span><span class="at"> </span><span class="st">"yes"</span></span></code></pre></div>
<p>The first line is a name for this connection; subsequent lines
contain information about the connection.</p>
<p>The <strong>driver_type</strong> line defines the brand of database,
and hence the driver package that will be used. This parameter is
required. Current options are:</p>
<ul>
<li>‘odbc’ (odbc)</li>
<li>‘sqlserver’ (odbc)</li>
<li>‘sqlite’ (RSQLite)</li>
<li>‘postgresql’ (RPostgres)</li>
<li>‘mariadb’(RMariaDB)</li>
<li>‘mysql’(RMariaDB)</li>
<li>‘bigquery’ (bigquery)</li>
</ul>
<p>The <strong>pool</strong> line determines whether a single connection
is required (as returned by <code><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">DBI::dbConnect()</a></code>) or a pool of
connections (as returned by <code><a href="http://rstudio.github.io/pool/reference/dbPool.html" class="external-link">pool::dbPool()</a></code>). The latter is
recommended for <a href="https://shiny.posit.co/" class="external-link">shiny</a>
applications. This parameter defaults to ‘no’, meaning a single
connection will be provided.</p>
<p>The <strong>description</strong> line provides a short description of
this connection. This parameter can be omitted.</p>
<p>The <strong>connection</strong> section contains several lines which
provide the parameters required for the connection itself, to be passed
to the constructor function as name=value pairs. For example, you will
need to supply a <code>Driver</code> connection string if you are using
an <code>odbc</code> driver. The <strong>server</strong> parameter will
probably always be required but see <code><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">DBI::dbConnect()</a></code> for
more details.</p>
<p>In summary, the elements needed for every connection are:</p>
<ol>
<li>The connection <strong>name</strong>, and</li>
<li>the <strong>driver_type</strong>, and</li>
<li>a <strong>connection</strong> section containing a
<strong>Server</strong> element</li>
</ol>
<p>The others <em>may</em> be needed for some connections or may be
omitted entirely. The function <code><a href="../reference/config_examples.html">config_examples()</a></code> provides
several example configurations.</p>
</div>
<div class="section level3">
<h3 id="the-config-search-path">The config search path<a class="anchor" aria-label="anchor" href="#the-config-search-path"></a>
</h3>
<p>By default, the <code><a href="../reference/connect.html">connect()</a></code> function reads not only the
config file named by its <code>config_filename</code> parameter, but
also any config files found on a search path that includes both the
user’s and the site’s config directories.</p>
<p>If you use the same database connections often, you can place a
config file called <code>sqlhelper_db_config.yml</code> in the directory
named by <code><a href="https://rappdirs.r-lib.org/reference/user_data_dir.html" class="external-link">rappdirs::user_config_dir()</a></code>. Similarly, if you are
a site admin you can provide your users with pre-configured connections
by placing a config file of the same name in the directory named by
<code><a href="https://rappdirs.r-lib.org/reference/site_data_dir.html" class="external-link">rappdirs::site_config_dir()</a></code>. In either of these cases, no
config filename is needed and <code><a href="../reference/connect.html">connect()</a></code> can be called
without arguments. Nonetheless, in the case where you require additional
connections to those provided by user- and site-wide configurations, you
may provide a <code>config_filename</code> argument.</p>
</div>
<div class="section level3">
<h3 id="suppressing-the-config-search-path">Suppressing the config search path<a class="anchor" aria-label="anchor" href="#suppressing-the-config-search-path"></a>
</h3>
<p>If only one config file is wanted, the config search path may be
suppressed by supplying the <code>exclusive = TRUE</code> argument.</p>
<p>If <code>exclusive = TRUE</code>, then <code><a href="../reference/connect.html">connect()</a></code> will
check whether the <code>config_filename</code> parameter is ‘user’ or
‘site’. If <code>config_filename</code> is one of those, the user- or
site-wide config file will be sought; if it is not, it will be treated
as the name of a config file, and that file will be sought.</p>
</div>
<div class="section level3">
<h3 id="file-precedence-inheritance-and-conflicts-across-config-files">File precedence, inheritance, and conflicts across config files<a class="anchor" aria-label="anchor" href="#file-precedence-inheritance-and-conflicts-across-config-files"></a>
</h3>
<p>If <code>exclusive == FALSE</code>, site-wide config files will be
read first, then user-wide, then named files. If conflicting connection
names or connection elements are encountered between config files,
values from later files overwrite those from earlier. This mechanism
operates element-wise; for example, if your site-wide config
contains:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_conn</span><span class="kw">:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">server_type</span><span class="kw">:</span><span class="at"> mysql</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">connection</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Server</span><span class="kw">:</span><span class="at"> </span><span class="st">"organization_server_host"</span></span></code></pre></div>
<p>but your named file contains:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_conn</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Private MySQL database</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">connection</span><span class="kw">:</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Server</span><span class="kw">:</span><span class="at"> </span><span class="st">"my_alternate_server_host"</span></span></code></pre></div>
<p>then <code>sqlhelper</code> will attempt to create a connection
described by:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_conn</span><span class="kw">:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">server_type</span><span class="kw">:</span><span class="at"> mysql</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Private MySQL database</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">connection</span><span class="kw">:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">Server</span><span class="kw">:</span><span class="at"> </span><span class="st">"my_alternate_server_host"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="browsing-the-connection-cache">Browsing the connection cache<a class="anchor" aria-label="anchor" href="#browsing-the-connection-cache"></a>
</h2>
<p>After <code><a href="../reference/connect.html">connect()</a></code> has been called, you may inspect the
created connections with <code><a href="../reference/connection_info.html">connection_info()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/connection_info.html">connection_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;   name          description                  live  default driver conn_str pool </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;glue&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> pool_sqlite   A pooled connection to an i… TRUE  FALSE   RSQLi… <span style="color: #BB0000;">NA</span>       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> simple_sqlite A simple connection to an i… TRUE  TRUE    RSQLi… <span style="color: #BB0000;">NA</span>       FALSE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="accessing-individual-connections">Accessing individual connections<a class="anchor" aria-label="anchor" href="#accessing-individual-connections"></a>
</h2>
<p>Connections may be accessed by name, with
<code><a href="../reference/live_connection.html">live_connection()</a></code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myconn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/live_connection.html">live_connection</a></span><span class="op">(</span><span class="st">"simple_sqlite"</span><span class="op">)</span></span>
<span><span class="va">myconn</span></span>
<span><span class="co">#&gt; &lt;SQLiteConnection&gt;</span></span>
<span><span class="co">#&gt;   Path: </span></span>
<span><span class="co">#&gt;   Extensions: TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-default-connection">The default connection<a class="anchor" aria-label="anchor" href="#the-default-connection"></a>
</h2>
<p>The first connection in the file with the highest precedence
(i.e. the last one to be read) becomes the default default. This
connection will be used whenever queries or files of SQL are executed
(<code><a href="../reference/run_queries.html">runqueries()</a></code> or <code><a href="../reference/run_files.html">runfiles()</a></code>) with without
explicitly stating which connection to use.</p>
<p>You can check the default connection with
<code><a href="../reference/connection_info.html">connection_info()</a></code> or <code><a href="../reference/set_default_conn_name.html">get_default_conn_name()</a></code>
and change it with <code><a href="../reference/set_default_conn_name.html">set_default_conn_name()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_default_conn_name.html">get_default_conn_name</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "simple_sqlite"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/set_default_conn_name.html">set_default_conn_name</a></span><span class="op">(</span><span class="st">"pool_sqlite"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/set_default_conn_name.html">get_default_conn_name</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "pool_sqlite"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/set_default_conn_name.html">get_default_conn_name</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/live_connection.html">live_connection</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;Pool&gt; of SQLiteConnection objects</span></span>
<span><span class="co">#&gt;   Objects checked out: 0</span></span>
<span><span class="co">#&gt;   Available in pool: 1</span></span>
<span><span class="co">#&gt;   Max size: Inf</span></span>
<span><span class="co">#&gt;   Valid: TRUE</span></span></code></pre></div>
<p>The last of these - combining <code><a href="../reference/set_default_conn_name.html">get_default_conn_name()</a></code>
with <code><a href="../reference/live_connection.html">live_connection()</a></code> to obtain the default connection -
is common enough to warrant a convenience function,
<code><a href="../reference/default_conn.html">default_conn()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="checking-closing-and-re-opening-connections">Checking, closing and re-opening connections<a class="anchor" aria-label="anchor" href="#checking-closing-and-re-opening-connections"></a>
</h2>
<p>You can check whether connections are live in two ways:</p>
<ol>
<li>
<code><a href="../reference/connection_info.html">connection_info()</a></code> provides a ‘live’ field for
interactive use</li>
<li>The functions <code><a href="../reference/is_connected.html">is_connected()</a></code> and
<code><a href="../reference/is_connected.html">not_connected()</a></code> are intended for programmatic use.</li>
</ol>
<p>To close all connections and remove them from the internal cache, use
<code><a href="../reference/disconnect.html">disconnect()</a></code>.</p>
<p>Individual connections may be closed with
<code><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">DBI::dbDisconnect()</a></code>.</p>
<p><code><a href="../reference/connect.html">connect()</a></code> closes any open connections before reading
config files.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conn_name</span> <span class="op">&lt;-</span> <span class="st">"simple_sqlite"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/is_connected.html">is_connected</a></span><span class="op">(</span><span class="va">conn_name</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/connection_info.html">connection_info</a></span><span class="op">(</span><span class="va">conn_name</span><span class="op">)</span><span class="op">$</span><span class="va">live</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">myconn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/live_connection.html">live_connection</a></span><span class="op">(</span><span class="va">conn_name</span><span class="op">)</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">myconn</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/connection_info.html">connection_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;   name          description                  live  default driver conn_str pool </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;glue&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> pool_sqlite   A pooled connection to an i… TRUE  TRUE    RSQLi… <span style="color: #BB0000;">NA</span>       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> simple_sqlite A simple connection to an i… FALSE FALSE   RSQLi… <span style="color: #BB0000;">NA</span>       FALSE</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="../reference/is_connected.html">not_connected</a></span><span class="op">(</span><span class="va">conn_name</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{conn_name} is not available, reconnecting..."</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="st">"examples/sqlhelper_db_conf.yml"</span>, exclusive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; simple_sqlite is not available, reconnecting...</span></span>
<span></span>
<span><span class="fu"><a href="../reference/connection_info.html">connection_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;   name          description                  live  default driver conn_str pool </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;glue&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> pool_sqlite   A pooled connection to an i… TRUE  FALSE   RSQLi… <span style="color: #BB0000;">NA</span>       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> simple_sqlite A simple connection to an i… TRUE  TRUE    RSQLi… <span style="color: #BB0000;">NA</span>       FALSE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/disconnect.html">disconnect</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/connection_info.html">connection_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew Roberts.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
